# /etc/supervisor/conf.d/agentedigital.conf
# Configuración de Supervisor para Agente Digital

[program:agentedigital]
# Comando para ejecutar la aplicación
command=/home/agentedigital/apps/agentedigital/start_gunicorn.sh
directory=/home/agentedigital/apps/agentedigital
user=agentedigital
group=agentedigital

# Configuración de autostart y autorestart
autostart=true
autorestart=true
autorestart_retries=3
startretries=3
exitcodes=0,2
stopsignal=TERM
stopwaitsecs=30
stopasgroup=true
killasgroup=true

# Configuración de logs
stdout_logfile=/home/agentedigital/logs/supervisor_stdout.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stdout_capture_maxbytes=1MB
stdout_events_enabled=false

stderr_logfile=/home/agentedigital/logs/supervisor_stderr.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
stderr_capture_maxbytes=1MB
stderr_events_enabled=false

# Variables de entorno
environment=
    PATH="/home/agentedigital/venv/bin:/usr/local/bin:/usr/bin:/bin",
    FLASK_ENV="production",
    PYTHONPATH="/home/agentedigital/apps/agentedigital"

# Configuración de prioridad (menor número = mayor prioridad)
priority=999

# Configuración de recursos
process_name=%(program_name)s_%(process_num)02d
numprocs=1

# Configuración de monitoreo
serverurl=AUTO

[group:agentedigital_group]
programs=agentedigital
priority=999